CC=sdcc
ZSTACK_PATH = /Volumes/ZStack/ZStack302
SDCC_PATH = /usr/local/Cellar/sdcc/4.0.0/
INC = 
INC += ../zstack-lib
INC += $(SDCC_PATH)/share/sdcc/include/
INC += $(SDCC_PATH)/share/sdcc/include/mcs51/
INC += $(ZSTACK_PATH)/Components/mac/include/
INC += $(ZSTACK_PATH)/Components/mt
INC += $(ZSTACK_PATH)/Components/zmac
INC += $(ZSTACK_PATH)/Components/zmac/f8w
INC += $(ZSTACK_PATH)/Components/osal/include
INC += $(ZSTACK_PATH)/Components/stack/af
INC += $(ZSTACK_PATH)/Components/stack/bdb
INC += $(ZSTACK_PATH)/Components/stack/sec
INC += $(ZSTACK_PATH)/Components/stack/sys
INC += $(ZSTACK_PATH)/Components/stack/zdo
INC += $(ZSTACK_PATH)/Components/stack/GP
INC += $(ZSTACK_PATH)/Components/stack/nwk
INC += $(ZSTACK_PATH)/Components/stack/zcl
INC += $(ZSTACK_PATH)/Components/hal/target/CC2530EB/
INC += $(ZSTACK_PATH)/Components/hal/include/
INC += $(ZSTACK_PATH)/Components/services/saddr/
INC += $(ZSTACK_PATH)/Components/services/sdata/
INC += $(ZSTACK_PATH)/Projects/zstack/ZMain/TI2530DB
INC += $(ZSTACK_PATH)/Projects/zstack/HomeAutomation/Source
INC_PARAMS=$(INC:%=-I%)
CFLAGS=-c --std-c11 -Wall $(INC_PARAMS)
CFLAGS += -Wp "-include preinclude.h"
CFLAGS += -DHAL_BOARD_FREEPAD
CFLAGS += -DHAL_UART=TRUE
CFLAGS += -DFREEPAD_ENABLE_TL
CFLAGS += -DZIGBEEPRO
CFLAGS += -DSECURE=1
CFLAGS += -DZG_SECURE_DYNAMIC=0
CFLAGS += -DREFLECTOR
CFLAGS += -DDEFAULT_CHANLIST=0x07FFF800
CFLAGS += -DZDAPP_CONFIG_PAN_ID=0xFFFF
CFLAGS += -DNWK_START_DELAY=100
CFLAGS += -DEXTENDED_JOINING_RANDOM_MASK=0x007F
CFLAGS += -DBEACON_REQUEST_DELAY=100
CFLAGS += -DBEACON_REQ_DELAY_MASK=0x00FF
CFLAGS += -DLINK_STATUS_JITTER_MASK=0x007F
CFLAGS += -DROUTE_EXPIRY_TIME=30
CFLAGS += -DAPSC_ACK_WAIT_DURATION_POLLED=3000
CFLAGS += -DNWK_INDIRECT_MSG_TIMEOUT=7
CFLAGS += -DMAX_RREQ_ENTRIES=8
CFLAGS += -DAPSC_MAX_FRAME_RETRIES=3
CFLAGS += -DNWK_MAX_DATA_RETRIES=2
CFLAGS += -DMAX_POLL_FAILURE_RETRIES=2
CFLAGS += -DMAX_BCAST=9
CFLAGS += -DAPS_MAX_GROUPS=1
CFLAGS += -DMAX_RTG_ENTRIES=40
CFLAGS += -DNWK_MAX_BINDING_ENTRIES=40
CFLAGS += -DMAX_BINDING_CLUSTER_IDS=4
CFLAGS += -DDEFAULT_KEY="{0}"
CFLAGS += -DMAC_MAX_FRAME_SIZE=116
CFLAGS += -DZDNWKMGR_MIN_TRANSMISSIONS=20
CFLAGS += -DCONST="const __code"
CFLAGS += -DGENERIC=__generic
CFLAGS += -DRFD_RCVC_ALWAYS_ON=FALSE
CFLAGS += -DPOLL_RATE=1000
CFLAGS += -DQUEUED_POLL_RATE=100
CFLAGS += -DRESPONSE_POLL_RATE=100
CFLAGS += -DREJOIN_POLL_RATE=440
CFLAGS += -DREJOIN_BACKOFF=900000
CFLAGS += -DREJOIN_SCAN=900000
CFLAGS += -DENABLE_LED4_DISABLE_S1
CFLAGS += -DFREEPAD_BUTTONS_COUNT=20
CFLAGS += --verbose
# $(info $$CFLAGS is [${CFLAGS}])
LDFLAGS=
SOURCES=zcl_freepadapp.c hal_key.c zcl_freepadapp_data.c OSAL_FreePadApp.c
OBJECTS=$(SOURCES:.c=.rel)
EXECUTABLE=hello

all: $(SOURCES) $(EXECUTABLE)
	
$(EXECUTABLE): $(OBJECTS) 
	$(CC) $(LDFLAGS) $(OBJECTS) -o $@

%.rel: %.c
	$(CC) $(CFLAGS) $< -o $@

clean:
	rm $(OBJECTS) $(EXECUTABLE)
